<!DOCTYPE html>
<html>
<head>
    <title>Web Space Program</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; color: #0f0; font-family: 'Courier New', monospace; }
        canvas { display: block; }
        #ui { position: absolute; top: 20px; left: 20px; border: 1px solid #0f0; padding: 10px; background: rgba(0,20,0,0.8); pointer-events: none; }
        .gauge { margin-bottom: 5px; }
    </style>
</head>
<body>
    <div id="ui">
        <div class="gauge">ALTITUDE: <span id="alt">0</span> km</div>
        <div class="gauge">VELOCITY: <span id="vel">0</span> m/s</div>
        <div class="gauge">FUEL: <span id="fuel">100</span>%</div>
        <hr>
        <div style="font-size: 0.8em;">W/S: Thrust | A/D: Rotate | SPACE: RCS Stabilize</div>
    </div>
    <canvas id="spaceCanvas"></canvas>

<script>
    const canvas = document.getElementById('spaceCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Physics Constants
    const G = 0.5; // Gravity strength
    const EARTH_X = canvas.width / 2;
    const EARTH_Y = canvas.height / 2;
    const EARTH_RADIUS = 100;

    const ship = {
        x: EARTH_X,
        y: EARTH_Y - 150,
        vx: 2, // Initial orbital velocity
        vy: 0,
        angle: -Math.PI / 2,
        thrust: 0.05,
        fuel: 1000,
        rotation: 0.05
    };

    const keys = {};
    window.onkeydown = (e) => keys[e.code] = true;
    window.onkeyup = (e) => keys[e.code] = false;

    function update() {
        // 1. Calculate Gravity
        let dx = EARTH_X - ship.x;
        let dy = EARTH_Y - ship.y;
        let distSq = dx*dx + dy*dy;
        let dist = Math.sqrt(distSq);
        let force = G * 5000 / distSq; // Inverse square law
        
        // Apply Gravity acceleration
        ship.vx += (dx / dist) * force;
        ship.vy += (dy / dist) * force;

        // 2. Player Input (Thrust)
        if (keys['KeyW'] && ship.fuel > 0) {
            ship.vx += Math.cos(ship.angle) * ship.thrust;
            ship.vy += Math.sin(ship.angle) * ship.thrust;
            ship.fuel -= 1;
        }
        if (keys['KeyS'] && ship.fuel > 0) {
            ship.vx -= Math.cos(ship.angle) * (ship.thrust * 0.5);
            ship.vy -= Math.sin(ship.angle) * (ship.thrust * 0.5);
            ship.fuel -= 0.5;
        }
        if (keys['KeyA']) ship.angle -= ship.rotation;
        if (keys['KeyD']) ship.angle += ship.rotation;

        // 3. RCS Stabilization (Spacebar)
        if (keys['Space']) {
            ship.vx *= 0.99; // Simple drag to simulate station keeping
            ship.vy *= 0.99;
        }

        // 4. Update Position
        ship.x += ship.vx;
        ship.y += ship.vy;

        // Update UI
        document.getElementById('alt').innerText = Math.round(dist - EARTH_RADIUS);
        document.getElementById('vel').innerText = Math.round(Math.sqrt(ship.vx**2 + ship.vy**2) * 100);
        document.getElementById('fuel').innerText = Math.max(0, Math.round(ship.fuel / 10));

        // Collision Check
        if (dist < EARTH_RADIUS) {
            alert("Touchdown or Crash! Resetting flight.");
            location.reload();
        }
    }

    function draw() {
        ctx.fillStyle = '#000';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Draw Earth
        ctx.beginPath();
        ctx.arc(EARTH_X, EARTH_Y, EARTH_RADIUS, 0, Math.PI * 2);
        ctx.fillStyle = '#2980b9'; // Blue Earth
        ctx.fill();
        ctx.strokeStyle = '#fff';
        ctx.stroke();

        // Draw Atmosphere glow
        ctx.beginPath();
        ctx.arc(EARTH_X, EARTH_Y, EARTH_RADIUS + 20, 0, Math.PI * 2);
        ctx.strokeStyle = 'rgba(100, 200, 255, 0.2)';
        ctx.stroke();

        // Draw Ship (The Command Module)
        ctx.save();
        ctx.translate(ship.x, ship.y);
        ctx.rotate(ship.angle);
        
        // Ship Body
        ctx.fillStyle = '#bdc3c7';
        ctx.beginPath();
        ctx.moveTo(10, 0);
        ctx.lineTo(-5, -7);
        ctx.lineTo(-5, 7);
        ctx.closePath();
        ctx.fill();

        // Thruster flame
        if (keys['KeyW'] && ship.fuel > 0) {
            ctx.fillStyle = '#f39c12';
            ctx.fillRect(-12, -3, 6, 6);
        }
        ctx.restore();

        update();
        requestAnimationFrame(draw);
    }

    draw();
</script>
</body>
</html>
